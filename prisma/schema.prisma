datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  avatarUrl String?

  episodeProgresses EpisodeProgress[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Series {
  id             String   @id @default(cuid())
  externalId     String
  externalSource String   // "tmdb", "imdb", etc.
  type           String   // "tv" o "movie"
  title          String
  overview       String?
  posterUrl      String?
  backdropUrl    String?
  totalSeasons   Int?

  episodeProgresses EpisodeProgress[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model EpisodeProgress {
  id            String   @id @default(cuid())
  userId        String
  seriesId      String
  seasonNumber  Int
  episodeNumber Int
  status        String   // "in_progress" | "completed"

  user   User   @relation(fields: [userId], references: [id])
  series Series @relation(fields: [seriesId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([userId, seriesId]) // un progreso por serie y usuario
}
